@page "/"
@inject IBoardGameRepository _boardGameRepo;
@inject IDialogService _dialogService;

<PageTitle>Index</PageTitle>

<MudContainer MaxWidth="MaxWidth.Large">
    <MudButton @onclick="OpenUserDialog" Variant="Variant.Filled" Color="Color.Primary" 
        StartIcon="@Icons.Material.Rounded.GroupAdd" Size="Size.Large">
        Create Session
    </MudButton>
    <MudButton @onclick="OpenSessionDialog" Variant="Variant.Filled" Color="Color.Primary" 
        StartIcon="@Icons.Material.Rounded.Hail" Size="Size.Large">
        Join Session
    </MudButton>
    @foreach(var game in Testing)
    {
        <BoardGameComponent GameToDisplay="@game" />
    }
</MudContainer>

@code 
{
    public List<BoardGame> Testing = new List<BoardGame>();

    protected override async Task OnInitializedAsync()
    {
        var number = new Random().Next(1, 10000);
        var temp = await _boardGameRepo.GetCollection("FricKtion95");
        Testing = BoardGameMapper.MapFromCollection(temp).ToList();
    }

    public void OpenUserDialog()
    {
        var options = new DialogOptions { CloseOnEscapeKey = true };
        _dialogService.Show<UserDialog>("Whose library?", options);
    }

    public void OpenSessionDialog() 
    {
        // TODO - This is almost exactly the same as the user dialog (including the actual dialog file). Generalize.
        var options = new DialogOptions { CloseOnEscapeKey = true };
        _dialogService.Show<SessionDialog>("Which session?", options);
    }
}